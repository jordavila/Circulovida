<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Círculo de la Vida</title>
<style>
  body {
    background-color: #fafafa;
    font-family: Arial, sans-serif;
    text-align: center;
    padding: 10px;
  }
  h1 {
    font-size: 1.3em;
    color: #333;
    margin-bottom: 5px;
  }
  #chart-container {
    position: relative;
    width: 100%;
    max-width: 500px;
    margin: auto;
  }
  input[type="text"] {
    padding: 8px;
    font-size: 1em;
    margin: 10px 0;
    width: 90%;
    max-width: 400px;
  }
  button {
    padding: 10px 20px;
    font-size: 1em;
    background-color: #4CAF50;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
  }
  button:hover {
    background-color: #45a049;
  }
</style>
</head>
<body>

<h1>
  CÍRCULO DE LA VIDA<br>
  Programa Raiz Viva<br>
  by: Karen Valencia - Health Coach
</h1>

<input type="text" id="nombre" placeholder="Ingresa tu nombre">

<div id="chart-container">
  <canvas id="lifeChart"></canvas>
</div>

<button id="downloadBtn">Descargar</button>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const categories = [
  "Salud Física",
  "Salud Emocional",
  "Carrera/Trabajo",
  "Dinero",
  "Desarrollo Personal",
  "Amigos/Familia",
  "Diversión/Ocio",
  "Pareja/Relaciones",
  "Entorno",
  "Espiritualidad"
];

let dataValues = Array(categories.length).fill(5);

const ctx = document.getElementById('lifeChart').getContext('2d');
const chart = new Chart(ctx, {
  type: 'radar',
  data: {
    labels: categories,
    datasets: [{
      label: 'Nivel',
      data: dataValues,
      fill: true,
      backgroundColor: 'rgba(54, 162, 235, 0.2)',
      borderColor: 'rgba(54, 162, 235, 1)',
      pointBackgroundColor: 'rgba(54, 162, 235, 1)',
      pointRadius: 6
    }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: true,
    scales: {
      r: {
        min: 0,
        max: 10,
        ticks: { stepSize: 1, color: '#333' },
        pointLabels: { font: { size: 14 }, color: '#111' }
      }
    },
    plugins: { legend: { display: false } },
    onClick: (evt) => {
      const points = chart.getElementsAtEventForMode(evt, 'nearest', { intersect: true }, true);
      if (points.length) {
        const index = points[0].index;
        let newValue = prompt(`Nuevo valor para "${categories[index]}" (1-10):`, dataValues[index]);
        if (newValue !== null) {
          newValue = parseInt(newValue);
          if (!isNaN(newValue) && newValue >= 1 && newValue <= 10) {
            dataValues[index] = newValue;
            chart.data.datasets[0].data = dataValues;
            chart.update();
          }
        }
      }
    }
  }
};

document.getElementById('downloadBtn').addEventListener('click', () => {
  const nombre = document.getElementById('nombre').value || "Sin nombre";
  const tempCanvas = document.createElement('canvas');
  const size = 1000;
  tempCanvas.width = size;
  tempCanvas.height = size + 50;
  const tempCtx = tempCanvas.getContext('2d');

  // Dibujar gráfico en el canvas temporal
  tempCtx.fillStyle = "#fff";
  tempCtx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);
  tempCtx.drawImage(chart.canvas, 0, 0, size, size);

  // Escribir el nombre
  tempCtx.fillStyle = "#000";
  tempCtx.font = "bold 28px Arial";
  tempCtx.textAlign = "center";
  tempCtx.fillText(`Nombre: ${nombre}`, size / 2, size + 35);

  const link = document.createElement('a');
  link.download = 'circulo_de_la_vida.png';
  link.href = tempCanvas.toDataURL();
  link.click();
});
</script>

</body>
</html>
